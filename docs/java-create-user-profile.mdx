---
title: "Create User Profile"
description: "This document will cover the methods to create a user and set channel preferences"
---

## Pre-requisites

[Integrate Java SDK](/docs/integrate-java-sdk)

## How Suprsend identifies a user

Suprsend identifies a user by a unique identifier `distinct_id`. The identifier for a user is important as we use this key to create user profile and all the information related to a user, like channel preferences, is attached to that profile. You can view user profile by searching `distinct_id` on [Subscribers page](https://app.suprsend.com/en/production/subscribers/subscribers/)

<Note>
  **Please note:** you cannot change a user's id once it has been set, so we recommend you use a non-transient id like a primary key rather than a phone number or email address.
</Note>

## Create a user and add communication channels

If you regularly trigger a workflow for users on some pre-decided channels, then instead of adding user channel details in each workflow request, you can set those channel details in the user profile once, and after that, in any workflow trigger request, you only need to pass the `distinct_id` of the user. All associated channels in the user profile will be automatically picked when executing the workflow.

For event based workflow triggers, you'll have to add channel preference first before sending the event

<Steps>
  <Step title="Create a new user">
    To create a new user or to update the profile of an existing user, you'll have to first instantiate the user object. Call `supr_client.user.getInstance` to instantiate user object.

    <CodeGroup>
      ```java java
      import org.json.JSONObject;

      import suprsend.Suprsend;
      import suprsend.Subscriber;

      public class Subscribers {
        public static void main(String[] args) throws Exception {
          getSubscriber();
        }
        
        private static Subscriber getSubscriber() throws SuprsendException {
      		Suprsend suprsendClient = new Suprsend("_workspace_key_", "_workspace_secret_");
      		// Instiantiate user
          String distinctId = "__distinct_id__";
      		Subscriber user = suprClient.user.getInstance(distinctId);
      		return user;
      	}
      ```
    </CodeGroup>
  </Step>

  <Step title="Set Communication Channel preferences">
    Communication Channel Preference decides whether a user will receive communication on a particular channel or not. Setting Channel preferences means that whenever you are triggering a workflow, the communication will be sent on the channels set in user profile (given that the template for that channel is present in the template group).

    Especially for event based workflow triggers, where you just pass the user's `distinct_id` and the communication channels are picked from user profile

    <Note>
      ðŸ“˜ **Set Channel Preference for event based workflows:**

      In event based workflows, since you only pass user's `distinct_id` in your track event call, you'll have to add channel preference first in user profile first before making the call.
    </Note>

    <Steps>
      <Step title="Add User Channels">
        Use `user.add*` method(s) to add user channels in a profile

        <CodeGroup>
          ```java java
          import org.json.JSONObject;

          import suprsend.Suprsend;
          import suprsend.Subscriber;

          public class Subscribers {
            public static void main(String[] args) throws Exception {
              addChannel();
            }

            public static void addChannel() throws Exception {
              // SDK instance
              Suprsend suprsendClient = new Suprsend("workspace_key", "workspace_secret");
              // Subscriber Instance
              String distinctID = "__distinct_id__";
              Subscriber user = suprsendClient.user.getInstance(distinctID);
              
              // Add Email
              user.addEmail("user@example.com");
              
              //Add SMS
              user.addSms("+919999999999");
              
              //Add Whatsapp
              user.addWhatsapp("+919999999999");
              
              // Add Androidpush token.Pass the vendor as 2nd param.
              user.addAndroidpush("androidpush_fcm_token__","fcm");
              user.addAndroidpush("androidpush_xiaomi_token__", "xiaomi");
              
              // Add iospush token 
          		user.addIospush("__iospush_apns_token__");
              
              // Add Slack using user email id
              JSONObject slackIdent = new JSONObject()
          				.put("access_token", "xoxb-XXXXXXXX")
                  .put("email", "user@example.com");
              user.addSlack(slackIdent);
              
              // Add Slack using member_id of the user if known
              JSONObject slackIdent = new JSONObject()
          				.put("access_token", "xoxb-XXXXXXXX")
                  .put("user_id", "U03XXXXXXXX");
              user.addSlack(slackIdent);
              
              // Add Slack channel_id
              JSONObject slackIdent = new JSONObject()
          				.put("access_token", "xoxb-XXXXXXXX")
                  .put("channel_id", "C04XXXXXXXX");
              user.addSlack(slackIdent);
              
              // Add Slack incoming webhook
              JSONObject slackIdent = new JSONObject()
          				.put("incoming_webhook", new JSONObject().put("url", "https://hooks.slack.com/services/TXXXXXXXXX/BXXXXXXXX/XXXXXXXXXXXXXXXXXXX"))
              user.addSlack(slackIdent); 
              
              // Add Webpush token json (VAPID)
              JSONObject webpush = new JSONObject()
                  .put("endpoint", "__end_point__")
                  .put("expirationTime", "")
                  .put("keys", new JSONObject()
                      .put("p256dh", "__p256dh__")
                      .put("auth", "__auth_key__"));
              user.addWebpush(webpush, "vapid");
              
              // Save
              JSONObject response = user.save();
              System.out.println(response);
            }
          ```
        </CodeGroup>
      </Step>

      <Step title="Remove User Channels">
        Use `user.remove*` method(s) to remove channels from a user profile

        <CodeGroup>
          ```java java
          import org.json.JSONObject;

          import suprsend.Suprsend;
          import suprsend.Subscriber;

          public class Subscribers {
            public static void main(String[] args) throws Exception {
              removeChannel();
            }

            public static void removeChannel() throws Exception {
              // SDK instance
              Suprsend suprsendClient = new Suprsend("workspace_key", "workspace_secret");
              // Subscriber Instance
              String distinctID = "__distinct_id__";
              Subscriber user = suprsendClient.user.getInstance(distinctID);
              
              // Remove Email
              user.removeEmail("user@example.com");
              
              //Remove SMS
              user.removeSms("+919999999999");
              
              //Remove Whatsapp
              user.removeWhatsapp("+919999999999");
              
              // Remove Androidpush token.Pass the vendor as 2nd param.
              user.removeAndroidpush("androidpush_fcm_token__","fcm");
              user.removeAndroidpush("androidpush_xiaomi_token__", "xiaomi");
              
              // Remove iospush token 
          		user.removeIospush("__iospush_apns_token__");
              
              // Remove Slack using user email id
              JSONObject slackIdent = new JSONObject()
          				.put("access_token", "xoxb-XXXXXXXX")
                  .put("email", "user@example.com");
              user.removeSlack(slackIdent);
              
              // Remove Slack using member_id of the user if known
              JSONObject slackIdent = new JSONObject()
          				.put("access_token", "xoxb-XXXXXXXX")
                  .put("user_id", "U03XXXXXXXX");
              user.removeSlack(slackIdent);
              
              // Remove Slack channel_id
              JSONObject slackIdent = new JSONObject()
          				.put("access_token", "xoxb-XXXXXXXX")
                  .put("channel_id", "C04XXXXXXXX");
              user.removeSlack(slackIdent);
              
              // Remove Slack incoming webhook
              JSONObject slackIdent = new JSONObject()
          				.put("incoming_webhook", new JSONObject().put("url", "https://hooks.slack.com/services/TXXXXXXXXX/BXXXXXXXX/XXXXXXXXXXXXXXXXXXX"))
              user.removeSlack(slackIdent); 
              
              // Remove Webpush token json (VAPID)
              JSONObject webpush = new JSONObject()
                  .put("endpoint", "__end_point__")
                  .put("expirationTime", "")
                  .put("keys", new JSONObject()
                      .put("p256dh", "__p256dh__")
                      .put("auth", "__auth_key__"));
              user.removeWebpush(webpush, "vapid");
              
              // Save
              JSONObject response = user.save();
              System.out.println(response);
            }
          ```
        </CodeGroup>
      </Step>

      <Step title="Remove User Channels in bulk">
        If you need to delete/unset all emails (or any other channel) of a user, you can call `user.unset()` method on the user instance. The method accepts the channel key/s (a single key or list of keys)

        <CodeGroup>
          ```java java
          import org.json.JSONObject;

          import suprsend.Suprsend;
          import suprsend.Subscriber;

          public class Subscribers {
            public static void main(String[] args) throws Exception {
              unsetChannel();
            }

            public static void unsetChannel() throws Exception {
              // SDK instance
              Suprsend suprsendClient = new Suprsend("workspace_key", "workspace_secret");
              // Subscriber Instance
              String distinctID = "__distinct_id__";
              Subscriber user = suprsendClient.user.getInstance(distinctID);

              // --- To unset one channel, for example to delete all emails associated with user
              user.unset("$email");
              
              //what value to pass to unset channels
              // for email:                $email
              // for whatsapp:             $whatsapp
              // for SMS:                  $sms
              // for androidpush tokens:   $androidpush
              // for iospush tokens:       $iospush
              // for webpush tokens:       $webpush
              // for slack:                $slack
              
              // --- multiple channels can also be deleted in one call by passing argument as a list
              ArrayList<String> channels =  new ArrayList<>(Arrays.asList("$email","$slack","$androidpush","$iospush","$webpush","$whatsapp"));
              user.unset(channels);
              
              // Save
              JSONObject response = user.save();
              System.out.println(response);
            }
          ```
        </CodeGroup>

        <Warning>
          After calling `add*/remove*/unset` methods, don't forget to call `user.save()`. On call of save(), SDK sends the request to SuprSend platform to update the User Profile.
        </Warning>
      </Step>
    </Steps>
  </Step>
</Steps>

## Add Preferences in User Profile

You can also set custom properties in user profile that is used to set user preferences

## Set Preferred language

If you want to send notification in user's preferred language, you can set it by passing [language code](https://github.com/suprsend/suprsend-py-sdk/blob/main/src/suprsend/language_codes.py) in `user.setPreferredLanguage()` method. This is useful especially for the applications which offer vernacular or multi-lingual support.

<CodeGroup>
  ```java java
  import org.json.JSONObject;

  import suprsend.Suprsend;
  import suprsend.Subscriber;

  public class Subscribers {
    public static void main(String[] args) throws Exception {
      setPreference();
    }

    public static void setPreference() throws Exception {
      // SDK instance
      Suprsend suprsendClient = new Suprsend("workspace_key", "workspace_secret");
      // Subscriber Instance
      String distinctID = "__distinct_id__";
      Subscriber user = suprsendClient.user.getInstance(distinctID);

      // Pass language in ISO 639-1 code
      user.setPreferredLanguage("es");
      
      // Save
      JSONObject response = user.save();
      System.out.println(response);
    }
  ```
</CodeGroup>

**Response:**

When you call `user.save()`, the SDK internally makes an `HTTP` call to SuprSend Platform to register this request, and you'll immediately receive a response indicating the acceptance / failure status.

<CodeGroup>
  ```java java
  // Response structure
  {
      "success": true, // if true, request was accepted.
      "status": "success",
      "status_code": 202, // http status code
      "message": "OK",
  }

  {
      "success": false, // error will be present in message
      "status": "fail",
      "status_code": 500, // http status code
      "message": "error message",
  }
  ```
</CodeGroup>

## Bulk API for handling multiple user profiles

To update user profiles in bulk, use Bulk users API. There isn't any limit on number-of-records that can be added to `bulkIns` instance.

Use `.append()` on bulk\_users instance to add however-many-records to call in bulk.

<CodeGroup>
  ```java java
  import org.json.JSONObject;

  import suprsend.Suprsend;
  import suprsend.Subscriber;

  public class Subscribers {
    public static void main(String[] args) throws Exception {
      bulkSubscriber();
    }

    public static void bulkSubscriber() throws Exception {
      // SDK instance
      Suprsend suprsendClient = new Suprsend("workspace_key", "workspace_secret");
      
      //Creating bulk instance
      BulkSubscribers bulkIns = suprClient.bulkUsers.newInstance();
      
      // Prepare multiple users
      String distinctID1 = "__distinct_id1__"; // User 1
      Subscriber u1 = suprsendClient.user.getInstance(distinctID1);
      u1.addEmail("user1@example.com");
      
      String distinctID2 = "__distinct_id2__"; // User 2
      Subscriber u2 = suprsendClient.user.getInstance(distinctID2);
      u2.addEmail("user2@example.com");
      
      // --- use .append on bulk instance to add one or more records
      bulkIns.append(u1);
      bulkIns.append(u2);
      // OR
      bulkIns.append(u1, u2);

      // Save
      JSONObject response = bulkIns.save();
      System.out.println(response);
    }
  ```
</CodeGroup>

<Warning>
  **Bulk API supported in SDK version 0.2.0 and above:**

  Bulk API is supported in SuprSend java-sdk version 0.5.0 and above. If you are using an older version, please upgrade to the latest SDK version.
</Warning>

### How SuprSend Processes the bulk API request

* On calling `bulkIns.save()`, the SDK internally makes one-or-more Callable-chunks.

* Each callable-chunk contains a subset of records, the subset calculation is based on each record's bytes-size and max allowed chunk-size, chunk-length etc.

* For each callable-chunk SDK makes an HTTP call to SuprSend to register the request.

**Response:**

Response is an instance of `suprsend.BulkResponse` class

<CodeGroup>
  ```java java
  // Response structure
  import suprsend.BulkResponse;

  BulkResponse{status: 'success' | total: 2 | success: 2 | failure: 0 | warnings: 0}

  BulkResponse{status: 'fail' | total: 2 | success: 0 | failure: 2 | warnings: 0}

  BulkResponse{status: 'partial' | total: 2 | success: 1 | failure: 1 | warnings: 0}
  ```
</CodeGroup>

## Advanced Configuration - Set User Properties

You can use SuprSend Python SDK to set advanced user properties, which will help in creating a user profile. You can use these properties to create user cohorts on SuprSend's platform with future releases.

<AccordionGroup>
  <Accordion title="Set" defaultOpen={false}>
    Set is used to set the custom user property or properties. The given name and value will be assigned to the user, overwriting an existing property with the same name if present. It can take key as first param, value as second param for setting single user property or object for setting multiple user properties.

    ```python
    from suprsend import Suprsend
    supr_client = Suprsend("WORKSPACE_KEY", "WORKSPACE_SECRET")

    distinct_id = "__uniq_user_identifier__"
    u1 = supr_client.user.get_instance(distinct_id)
    u1.set("key", "value")  # for single property
    u1.set(properties)      # for multiple properties where properties is a dict()

    # set single property using key and value
    u1.set("name", "user")
    # set multiple/nested properties using dictionary
    u1.set({
      "prop1": "val1", 
      "prop2": ["one", "two", "three"], 
      "number": 20
    })
    ```

    &#x20;

    | Parameters | Type              | Description                                                                                                                                                                                                                                                                                         |
    | ---------- | ----------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
    | **arg1**   | string/dictionary | *Mandatory*&#xA;This param will be string in case where only single property needs to be created/updated. It will be a dictionary in cases where complex objects need to be set in user properties, like multiple properties, arrays, nested properties etc.&#xA;Should not start withÂ `$`Â orÂ `ss_` |
    | **arg2**   | any               | *Optional*&#xA;This will be value that will be attached to key property. Not required in cases where first param is a dictionary.                                                                                                                                                                   |

    <Warning>
      > ## Naming GuidelinesWhen you create a key, please ensure that the Key Name does not start withÂ **`$`**Â orÂ **`ss_`**, as we have reserved these symbols for our internal events and property names.
    </Warning>
  </Accordion>

  <Accordion title="Set Once" defaultOpen={false}>
    Works just likeÂ `user.set`, except it will not overwrite existing property values. This is useful for properties likeÂ *First login date*

    ```
    from suprsend import Suprsend
    supr_client = Suprsend("WORKSPACE_KEY", "WORKSPACE_SECRET")

    distinct_id = "__uniq_user_identifier__"
    u1 = supr_client.user.get_instance(distinct_id)
    u1.set_once(key, value)  # for single property
    u1.set_once(properties)  # for multiple properties

    # For setting once a single property:
    u1.set_once("first_login", "2021-11-02")

    # For setting once multiple properties
    u1.set_once({"first_login" : "2021-11-02", "DOB" : "1991-10-02"})
    ```
  </Accordion>

  <Accordion title="Increment" defaultOpen={false}>
    Add the given amount to an existing property on the user. If the user does not already have the associated property, the amount will be added to zero. To reduce a property, provide a negative number for the value.

    ```
    from suprsend import Suprsend
    supr_client = Suprsend("WORKSPACE_KEY", "WORKSPACE_SECRET")

    distinct_id = "__uniq_user_identifier__"
    u1 = supr_client.user.get_instance(distinct_id)
    u1.increment(key, value)  # for single property
    u1.increment(property_obj)  # for multiple properties

    # For incrementing a single property:
    u1.increment("login_count", 1)

    # For incrementing multiple properties:
    u1.increment({"login_count" : 1, "order_count" : 1})
    ```
  </Accordion>

  <Accordion title="Append" defaultOpen={false}>
    This method will append a value to the list for a given property.

    ```
    from suprsend import Suprsend
    supr_client = Suprsend("WORKSPACE_KEY", "WORKSPACE_SECRET")

    distinct_id = "__uniq_user_identifier__"
    u1 = supr_client.user.get_instance(distinct_id)
    u1.append(key, value)  # for single property
    u1.append(properties)  # for multiple properties

    # For appending a single property:
    u1.append("wishlist", "iphone12")

    # For appending multiple properties:
    u1.append({"wishlist" : "iphone12", "wishlist" : "Apple airpods"})
    ```
  </Accordion>

  <Accordion title="Remove" defaultOpen={false}>
    This method will remove a value from the list for a given property.

    ```python
    from suprsend import Suprsend
    supr_client = Suprsend("WORKSPACE_KEY", "WORKSPACE_SECRET")

    distinct_id = "__uniq_user_identifier__"
    u1 = supr_client.user.get_instance(distinct_id)
    u1.remove(key, value)  # for single property
    u1.remove(properties)  # for multiple properties

    # For removing a single property:
    u1.remove("wishlist", "iphone12")

    # For removing multiple properties:
    u1.remove({"wishlist" : "iphone12", "wishlist": "Apple airpods"})
    ```
  </Accordion>

  <Accordion title="Unset" defaultOpen={false}>
    This will remove a property permanently from user properties.

    ```python

    from suprsend import Suprsend
    supr_client = Suprsend("WORKSPACE_KEY", "WORKSPACE_SECRET")

    distinct_id = "__uniq_user_identifier__"
    u1 = supr_client.user.get_instance(distinct_id)
    u1.unset(key)  # for single property
    u1.unset(property_list)  # for multiple properties

    # For unsetting a single property:
    u1.unset("wishlist")

    # For unsetting multiple properties:
    u1.unset(["wishlist", "cart"])
    ```
  </Accordion>
</AccordionGroup>

| Parameters         | Type           | Description                                                       |
| ------------------ | -------------- | ----------------------------------------------------------------- |
| **key**            | string         | This property provided will be deleted from user properties       |
| **property\_list** | array\[string] | If list is given all properties included in list will be removed. |

***